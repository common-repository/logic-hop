function logichop_modal_open(o){(o=void 0!==o&&o)&&(jQuery(".logichop_insert_data").attr("data-target",o),jQuery("#logichop-modal-conditions-tab, #logichop-modal-blocks-tab, #logichop-modal-goals-tab").hide(),jQuery("#logichop-modal-conditions, #logichop-modal-blocks, #logichop-modal-goals").hide(),jQuery("#logichop-modal-data").addClass("nav-tab-display-active"),jQuery("#logichop-modal-data-tab").addClass("nav-tab-active")),jQuery("#logichop-modal-backdrop").fadeIn(),jQuery("#logichop-modal-wrap").fadeIn()}jQuery(function(o){function e(){return"undefined"!=typeof tinyMCE&&tinyMCE.activeEditor&&!tinyMCE.activeEditor.isHidden()}var a="";function t(){o("#logichop-modal-backdrop").hide(),o("#logichop-modal-wrap").hide(),o(".logichop-modal-form input").val(""),o(".logichop-modal-form select").each(function(){o(this)[0].selectedIndex=0})}function i(){o("#_logichop_page_goal_js_event").val()&&o("#_logichop_page_goal_js_element").val()&&o("#_logichop_page_goal_js").val()?o(this).parent().removeClass("half-set").addClass("set"):o("#_logichop_page_goal_js_event").val()||o("#_logichop_page_goal_js_element").val()||o("#_logichop_page_goal_js").val()?o(this).parent().removeClass("set").addClass("half-set"):o(this).parent().removeClass("half-set set")}function l(){o("#_logichop_page_condition").val()&&o("#_logichop_page_redirect").val()?o(this).parent().removeClass("half-set").addClass("set"):o("#_logichop_page_condition").val()||o("#_logichop_page_redirect").val()?o(this).parent().removeClass("set").addClass("half-set"):o(this).parent().removeClass("half-set set")}function n(){return"undefined"!=typeof tinyMCE&&tinyMCE.activeEditor&&!tinyMCE.activeEditor.isHidden()?tinyMCE.activeEditor.selection.getContent():a}o("#content").on("mouseout mouseup keyup",function(){window.getSelection()&&(a=window.getSelection().toString())}),o("#logichop-modal-backdrop, .logichop-modal-close, .logichop-modal-cancel").on("click",t),o(".logichop-modal-content .nav-tab").on("click",function(e){o(".logichop-modal-content .nav-tab").removeClass("nav-tab-active"),o(this).addClass("nav-tab-active"),o(".nav-tab-display").removeClass("nav-tab-display-active"),o("."+o(this).attr("data-tab")).addClass("nav-tab-display-active"),e.preventDefault()}),o(".logichop_insert_condition").on("click",function(e){var a=o("#logichop_condition_logic").val(),i=o("#logichop_condition").val(),l=o("#logichop_condition option:selected").attr("data-slug"),c="",s=n();i&&l&&("if"==a&&(s||(s="## IF CONTENT ##"),c="{% if condition: "+l+" %} "+s+" {% endif %}"),"if not"==a&&(s||(s="## IF NOT CONTENT ##"),c="{% if condition: !"+l+" %} "+s+" {% endif %}"),"if else"==a&&(s||(s="## IF CONTENT ##"),c="{% if condition: "+l+" %} "+s+" {% else %} ## ELSE CONTENT ## {% endif %}"),"if not else"==a&&(s||(s="## IF NOT CONTENT ##"),c="{% if condition: !"+l+" %} "+s+" {% else %} ## ELSE CONTENT ## {% endif %}"),"else if"==a&&(s||(s="## ELSE IF CONTENT ## "),c=" {% elseif condition: "+l+" %} "+s),"else if not"==a&&(s||(s="## ELSE IF NOT CONTENT ## "),c="{% elseif condition: !"+l+" %} "+s)),"else"==a&&(s||(s="## ELSE CONTENT ## "),c="{% else %} "+s),c&&(window.send_to_editor(c),t()),e.preventDefault()}),o(".logichop_insert_query_condition").on("click",function(e){var a=o("#logichop_query_logic").val(),i=o("#logichop_query_operator").val(),l=o("#logichop_query_value").val(),c=n();a&&i&&l&&(c||(c="## IF CONTENT ##"),window.send_to_editor("{% if query: "+a+" "+i+" "+l+" %} "+c+" {% endif %}"),t()),e.preventDefault()}),o("#logichop_insert_goal").on("click",function(a){var i=o("#logichop_goal").val(),l=o("#logichop_goal option:selected").attr("data-slug"),n="delete"==o("#logichop_goal_delete").val()?" | delete: true":"";if(i&&l){var c="{{ goal: "+l+n+" }} ";e()&&(c+="&nbsp;"),window.send_to_editor(c),t()}a.preventDefault()}),o("#logichop_insert_conditional_goal").on("click",function(a){var i=o("#logichop_conditional").val(),l=o("#logichop_conditional option:selected").attr("data-slug"),n=o("#logichop_conditional_goal_not").val(),c=o("#logichop_conditional_goal").val(),s=o("#logichop_conditional_goal option:selected").attr("data-slug"),_="delete"==o("#logichop_conditional_goal_delete").val()?" | delete: true":"";if(i&&l&&c&&s){var d="{{ goal: "+s+" | condition: "+n+l+_+" }} ";e()&&(d+="&nbsp;"),window.send_to_editor(d),t()}a.preventDefault()}),o("#logichop_insert_logicblock").on("click",function(e){var a=o("#logichop_logicblock").val();if(a){var i='[logichop_block id="'+a+'"] ';window.send_to_editor(i),t()}e.preventDefault()}),o(".logichop_insert_data").on("click",function(a){var i=o(this).attr("data-input"),l=o(this).attr("data-target"),n=o(i).val(),c=o(i+"_default").val()?" | default: "+o(i+"_default").val():"",s=o(i+"_event").val()?" | event: "+o(i+"_event").val():"",_=o(i+"_case").val()?" | case: "+o(i+"_case").val():"",d=o(i+"_class").val()?" | class: "+o(i+"_class").val():"";if(n){var g="{{ var: "+n+c+s+_+d+" }}";if(l){var p=o(l).getCursorPosition(),r=o(l).val(),h=r.substr(0,p)+g+r.substr(p);o(l).val(h).trigger("keyup")}else e()&&(g+="&nbsp;"),window.send_to_editor(g);t()}a.preventDefault()}),o("#logichop_insert_else").on("click",function(o){window.send_to_editor("{% else %}"+n()),t(),o.preventDefault()}),o(".logichop-meta-clear").on("click",function(e){var a=o(this).closest(".logichop-meta");a.removeClass("half-set set").children("select, input").val(""),a.children('input[type="number"]').val("0"),e.preventDefault()}),o("#_logichop_page_leadscore").on("change",function(){0!=o(this).val()?o(this).parent().addClass("set"):o(this).parent().removeClass("set")}),o("#_logichop_page_goal").on("change",function(){o(this).val()?o(this).parent().addClass("set"):o(this).parent().removeClass("set")}),o("#_logichop_disable_js_mode").on("change",function(){o(this).val()?(o(this).parent().addClass("set"),o("#_disable_meta").show()):(o(this).parent().removeClass("set"),o("#_disable_meta").hide())}),o("#_logichop_page_goal_condition, #_logichop_page_goal_on_condition").on("change",function(){o("#_logichop_page_goal_condition").val()&&o("#_logichop_page_goal_on_condition").val()?o(this).parent().removeClass("half-set").addClass("set"):o("#_logichop_page_goal_condition").val()||o("#_logichop_page_goal_on_condition").val()?o(this).parent().removeClass("set").addClass("half-set"):o(this).parent().removeClass("half-set set")}),o("#_logichop_page_goal_js_event, #_logichop_page_goal_js_element, #_logichop_page_goal_js").on("change",i),o("#_logichop_page_goal_js_element").on("keyup",i),o("#_logichop_page_condition, #_logichop_page_redirect").on("change",l),o("#_logichop_page_redirect").on("keyup",l),o.fn.getCursorPosition=function(){var e=o(this).get(0),a=0;if("selectionStart"in e)a=e.selectionStart;else if("selection"in document){e.focus();var t=document.selection.createRange(),i=document.selection.createRange().text.length;t.moveStart("character",-e.value.length),a=t.text.length-i}return a}});
